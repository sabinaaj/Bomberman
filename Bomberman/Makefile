TARGET = ajksnsab

CXX = g++
MKDIR = mkdir -p

CXXFLAGS = -g -Wall -std=c++17 -pedantic
LIBFLAGS = -lncurses -pthread

SOURCE_DIR = src
BUILD_DIR = build

SOURCES = $(wildcard $(SOURCE_DIR)/*.cpp)
HEADERS = $(wildcard $(SOURCE_DIR)/*.h)


OBJECTS = $(SOURCES:$(SOURCE_DIR)/%.cpp=$(BUILD_DIR)/%.o)


all: compile doc


compile: $(TARGET)


run: $(TARGET)
	./$(TARGET)


$(TARGET): $(OBJECTS)
	$(CXX) $^ $(LIBFLAGS) -o $@


$(BUILD_DIR)/%.o: $(SOURCE_DIR)/%.cpp
	$(MKDIR) $(BUILD_DIR)
	$(CXX) $(CXXFLAGS) $< -c -o $@


doc: Doxyfile $(HEADERS)
	doxygen Doxyfile

clean:
	rm -rf $(TARGET) $(TARGET).zip doc/ .archive/ $(BUILD_DIR)/ 2>/dev/null
	
# Dependencies
# Generated by "g++ -MM src/*.cpp | sed -r 's|^(.*\.o)|build/\1|'"

build/CBomb.o: src/CBomb.cpp src/CBomb.h src/Constants.h
build/CGame.o: src/CGame.cpp src/CGame.h src/CPlayerAI.h src/CPlayer.h \
 src/CMap.h src/Constants.h src/CBomb.h
build/CMap.o: src/CMap.cpp src/CMap.h src/Constants.h
build/CMenu.o: src/CMenu.cpp src/CMenu.h src/CGame.h src/CPlayerAI.h \
 src/CPlayer.h src/CMap.h src/Constants.h src/CBomb.h
build/CPlayerAI.o: src/CPlayerAI.cpp src/CPlayerAI.h src/CPlayer.h src/CMap.h \
 src/Constants.h src/CBomb.h
build/CPlayer.o: src/CPlayer.cpp src/CPlayer.h src/CMap.h src/Constants.h \
 src/CBomb.h
build/main.o: src/main.cpp src/CMenu.h src/CGame.h src/CPlayerAI.h \
 src/CPlayer.h src/CMap.h src/Constants.h src/CBomb.h




